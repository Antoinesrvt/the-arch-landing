---
// Composant de sÃ©lection de langue
export interface Props {
  currentLang: string;
}

const { currentLang } = Astro.props;

const languages = [
  { code: 'fr', name: 'FranÃ§ais', flag: 'ðŸ‡«ðŸ‡·' },
  { code: 'en', name: 'English', flag: 'ðŸ‡¬ðŸ‡§' }
];
---

<div class="relative">
  <button 
    id="lang-switch" 
    class="ml-4 md:ml-8 text-sm font-semibold border border-white/50 rounded-full px-3 py-1 text-secondary-text hover:text-white hover:border-white transition-colors flex items-center gap-2" 
    aria-label="Changer de langue"
  >
    <span class="current-lang-flag">
      {languages.find(lang => lang.code === currentLang)?.flag || 'ðŸ‡«ðŸ‡·'}
    </span>
    <span class="current-lang-code">
      {currentLang === 'fr' ? 'EN' : 'FR'}
    </span>
  </button>
  
  <!-- Dropdown des langues -->
  <div id="lang-dropdown" class="absolute top-full right-0 mt-2 bg-black/90 backdrop-blur-md border border-white/20 rounded-lg py-2 min-w-[120px] hidden z-50">
    {languages.map((lang) => (
      <a 
        href={`/${lang.code}`}
        class={`block px-4 py-2 text-sm hover:bg-white/10 transition-colors flex items-center gap-2 ${
          lang.code === currentLang ? 'text-white bg-white/5' : 'text-secondary-text'
        }`}
        data-lang={lang.code}
      >
        <span>{lang.flag}</span>
        <span>{lang.name}</span>
      </a>
    ))}
  </div>
</div>

<script>
  // Gestion du dropdown de langue
  document.addEventListener('DOMContentLoaded', () => {
    const langSwitch = document.getElementById('lang-switch');
    const langDropdown = document.getElementById('lang-dropdown');
    
    if (langSwitch && langDropdown) {
      langSwitch.addEventListener('click', (e) => {
        e.preventDefault();
        langDropdown.classList.toggle('hidden');
      });
      
      // Fermer le dropdown en cliquant ailleurs
      document.addEventListener('click', (e) => {
        if (!langSwitch.contains(e.target as Node) && !langDropdown.contains(e.target as Node)) {
          langDropdown.classList.add('hidden');
        }
      });
    }
  });
</script>
